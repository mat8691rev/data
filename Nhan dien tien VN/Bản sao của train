{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"executionInfo":{"elapsed":11850,"status":"ok","timestamp":1724680050516,"user":{"displayName":"Trang Trần","userId":"05226583947426864371"},"user_tz":-420},"id":"mZMfRVR1XbSv"},"outputs":[],"source":["import os\n","import numpy as np\n","import matplotlib.pyplot as plt\n","import matplotlib.image as mpimg\n","import tensorflow as tf\n","from tensorflow import keras\n","from tensorflow.keras.preprocessing.image import ImageDataGenerator"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":28289,"status":"ok","timestamp":1724680078800,"user":{"displayName":"Trang Trần","userId":"05226583947426864371"},"user_tz":-420},"id":"0u2ZfRej5-Xw","outputId":"347f672c-cd49-43d7-86ec-ea3c4c21c1fa"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5121,"status":"ok","timestamp":1724680083912,"user":{"displayName":"Trang Trần","userId":"05226583947426864371"},"user_tz":-420},"id":"gEwbKeLaXwP_","outputId":"e9870f33-d1d7-48b5-ddcb-29b888c7da0f"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount(\"/content/drive\", force_remount=True)"]},{"cell_type":"code","execution_count":15,"metadata":{"executionInfo":{"elapsed":529,"status":"ok","timestamp":1724680648776,"user":{"displayName":"Trang Trần","userId":"05226583947426864371"},"user_tz":-420},"id":"weNw6SYkYMgr"},"outputs":[],"source":["train_dir = os.path.join('/content/drive/MyDrive/hhtqd/dataset/train')\n","labels = ['001000', '002000', '005000', '010000', '020000','050000','100000','200000','500000']\n","validation_dir = os.path.join('/content/drive/MyDrive/hhtqd/dataset/validation')\n","labels = ['001000', '002000', '005000', '010000', '020000','050000','100000','200000','500000']"]},{"cell_type":"code","execution_count":16,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"irbd_5KvbBZm","executionInfo":{"status":"ok","timestamp":1724680654758,"user_tz":-420,"elapsed":387,"user":{"displayName":"Trang Trần","userId":"05226583947426864371"}},"outputId":"2bc2f2ee-9fb1-4644-bca1-27ae42a99358"},"outputs":[{"output_type":"stream","name":"stdout","text":["Images of label \"001000\":\t 250\n","Images of label \"002000\":\t 250\n","Images of label \"005000\":\t 154\n","Images of label \"010000\":\t 250\n","Images of label \"020000\":\t 154\n","Images of label \"050000\":\t 154\n","Images of label \"100000\":\t 250\n","Images of label \"200000\":\t 250\n","Images of label \"500000\":\t 250\n"]}],"source":["#checking the size of data available to us for training out model\n","for label in labels:\n","  directory1 = os.path.join(train_dir,label)\n","  print(\"Images of label \\\"\" + label + \"\\\":\\t\", len(os.listdir(directory1)))"]},{"cell_type":"code","execution_count":17,"metadata":{"id":"CM090gF3cpc_","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1724680658500,"user_tz":-420,"elapsed":4,"user":{"displayName":"Trang Trần","userId":"05226583947426864371"}},"outputId":"e3ee7407-0a25-48fd-eb39-15891ea61373"},"outputs":[{"output_type":"stream","name":"stdout","text":["Images of label \"001000\":\t 12\n","Images of label \"002000\":\t 12\n","Images of label \"005000\":\t 12\n","Images of label \"010000\":\t 43\n","Images of label \"020000\":\t 75\n","Images of label \"050000\":\t 81\n","Images of label \"100000\":\t 108\n","Images of label \"200000\":\t 106\n","Images of label \"500000\":\t 110\n"]}],"source":["#checking the size of data available to us for validation out model\n","for label in labels:\n","  directory2 = os.path.join(validation_dir,label)\n","  print(\"Images of label \\\"\" + label + \"\\\":\\t\", len(os.listdir(directory2)))"]},{"cell_type":"code","execution_count":18,"metadata":{"colab":{"output_embedded_package_id":"14tVpSze_44vwIM_dijkLShM34lSNCmRf","base_uri":"https://localhost:8080/","height":433},"id":"9DzSTT4zdVeP","outputId":"912eaa90-b29f-432a-bbf1-44d948870169","executionInfo":{"status":"ok","timestamp":1724680680139,"user_tz":-420,"elapsed":18982,"user":{"displayName":"Trang Trần","userId":"05226583947426864371"}}},"outputs":[{"output_type":"display_data","data":{"text/plain":"Output hidden; open in https://colab.research.google.com to view."},"metadata":{}}],"source":["#plotting images of different review for understanding the dataset\n","plt.figure(figsize=(30,14))\n","\n","for i in range(9):\n","  directory = os.path.join(train_dir, labels[i])\n","  for j in range(10):\n","    path = os.path.join(directory, os.listdir(directory)[j])\n","    img = mpimg.imread(path)\n","    plt.subplot(9, 10, i*10 + j + 1)\n","    plt.imshow(img)\n","    if j == 0:\n","      plt.ylabel(labels[i], fontsize=20)\n","plt.setp(plt.gcf().get_axes(),xticks=[],yticks=[]);\n","plt.tight_layout()\n","plt.show()"]},{"cell_type":"code","execution_count":19,"metadata":{"id":"zf-XcLyqdjyb","executionInfo":{"status":"ok","timestamp":1724680693615,"user_tz":-420,"elapsed":520,"user":{"displayName":"Trang Trần","userId":"05226583947426864371"}}},"outputs":[],"source":["from tensorflow.keras.preprocessing.image import ImageDataGenerator\n","train_data_gen = ImageDataGenerator(rescale=1/255,)\n","validation_data_gen = ImageDataGenerator(rescale=1/255)"]},{"cell_type":"code","execution_count":20,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"tSVriPUo-pub","executionInfo":{"status":"ok","timestamp":1724680695526,"user_tz":-420,"elapsed":4,"user":{"displayName":"Trang Trần","userId":"05226583947426864371"}},"outputId":"cb29ec27-c021-4bf8-84ab-120075841953"},"outputs":[{"output_type":"stream","name":"stdout","text":["Found 1962 images belonging to 9 classes.\n","Found 559 images belonging to 9 classes.\n"]}],"source":["train_generator = train_data_gen.flow_from_directory(train_dir,\n","                                                    target_size=(144, 144),\n","                                                    batch_size=32,\n","                                                    class_mode='binary')\n","validation_generator = validation_data_gen.flow_from_directory(validation_dir,\n","                                                    target_size=(144, 144),\n","                                                    batch_size=32,\n","                                                    class_mode='binary')"]},{"cell_type":"code","execution_count":21,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":472},"id":"ZnmWQ9U4d6Rb","executionInfo":{"status":"ok","timestamp":1724680698190,"user_tz":-420,"elapsed":595,"user":{"displayName":"Trang Trần","userId":"05226583947426864371"}},"outputId":"e0c5f810-c504-4d91-fba1-71099281e940"},"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/keras/src/layers/convolutional/base_conv.py:107: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.\n","  super().__init__(activity_regularizer=activity_regularizer, **kwargs)\n"]},{"output_type":"display_data","data":{"text/plain":["\u001b[1mModel: \"sequential_1\"\u001b[0m\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\">Model: \"sequential_1\"</span>\n","</pre>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓\n","┃\u001b[1m \u001b[0m\u001b[1mLayer (type)                        \u001b[0m\u001b[1m \u001b[0m┃\u001b[1m \u001b[0m\u001b[1mOutput Shape               \u001b[0m\u001b[1m \u001b[0m┃\u001b[1m \u001b[0m\u001b[1m        Param #\u001b[0m\u001b[1m \u001b[0m┃\n","┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩\n","│ conv2d_3 (\u001b[38;5;33mConv2D\u001b[0m)                    │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m142\u001b[0m, \u001b[38;5;34m142\u001b[0m, \u001b[38;5;34m32\u001b[0m)        │             \u001b[38;5;34m896\u001b[0m │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ max_pooling2d_3 (\u001b[38;5;33mMaxPooling2D\u001b[0m)       │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m71\u001b[0m, \u001b[38;5;34m71\u001b[0m, \u001b[38;5;34m32\u001b[0m)          │               \u001b[38;5;34m0\u001b[0m │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ conv2d_4 (\u001b[38;5;33mConv2D\u001b[0m)                    │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m69\u001b[0m, \u001b[38;5;34m69\u001b[0m, \u001b[38;5;34m64\u001b[0m)          │          \u001b[38;5;34m18,496\u001b[0m │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ max_pooling2d_4 (\u001b[38;5;33mMaxPooling2D\u001b[0m)       │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m34\u001b[0m, \u001b[38;5;34m34\u001b[0m, \u001b[38;5;34m64\u001b[0m)          │               \u001b[38;5;34m0\u001b[0m │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ conv2d_5 (\u001b[38;5;33mConv2D\u001b[0m)                    │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m32\u001b[0m, \u001b[38;5;34m32\u001b[0m, \u001b[38;5;34m128\u001b[0m)         │          \u001b[38;5;34m73,856\u001b[0m │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ max_pooling2d_5 (\u001b[38;5;33mMaxPooling2D\u001b[0m)       │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m16\u001b[0m, \u001b[38;5;34m16\u001b[0m, \u001b[38;5;34m128\u001b[0m)         │               \u001b[38;5;34m0\u001b[0m │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ flatten_1 (\u001b[38;5;33mFlatten\u001b[0m)                  │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m32768\u001b[0m)               │               \u001b[38;5;34m0\u001b[0m │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ dense_2 (\u001b[38;5;33mDense\u001b[0m)                      │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m512\u001b[0m)                 │      \u001b[38;5;34m16,777,728\u001b[0m │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ dense_3 (\u001b[38;5;33mDense\u001b[0m)                      │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m9\u001b[0m)                   │           \u001b[38;5;34m4,617\u001b[0m │\n","└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓\n","┃<span style=\"font-weight: bold\"> Layer (type)                         </span>┃<span style=\"font-weight: bold\"> Output Shape                </span>┃<span style=\"font-weight: bold\">         Param # </span>┃\n","┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩\n","│ conv2d_3 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Conv2D</span>)                    │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">142</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">142</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">32</span>)        │             <span style=\"color: #00af00; text-decoration-color: #00af00\">896</span> │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ max_pooling2d_3 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">MaxPooling2D</span>)       │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">71</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">71</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">32</span>)          │               <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ conv2d_4 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Conv2D</span>)                    │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">69</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">69</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">64</span>)          │          <span style=\"color: #00af00; text-decoration-color: #00af00\">18,496</span> │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ max_pooling2d_4 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">MaxPooling2D</span>)       │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">34</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">34</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">64</span>)          │               <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ conv2d_5 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Conv2D</span>)                    │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">32</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">32</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">128</span>)         │          <span style=\"color: #00af00; text-decoration-color: #00af00\">73,856</span> │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ max_pooling2d_5 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">MaxPooling2D</span>)       │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">16</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">16</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">128</span>)         │               <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ flatten_1 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Flatten</span>)                  │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">32768</span>)               │               <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ dense_2 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)                      │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">512</span>)                 │      <span style=\"color: #00af00; text-decoration-color: #00af00\">16,777,728</span> │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ dense_3 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)                      │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">9</span>)                   │           <span style=\"color: #00af00; text-decoration-color: #00af00\">4,617</span> │\n","└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘\n","</pre>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["\u001b[1m Total params: \u001b[0m\u001b[38;5;34m16,875,593\u001b[0m (64.38 MB)\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Total params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">16,875,593</span> (64.38 MB)\n","</pre>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["\u001b[1m Trainable params: \u001b[0m\u001b[38;5;34m16,875,593\u001b[0m (64.38 MB)\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Trainable params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">16,875,593</span> (64.38 MB)\n","</pre>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["\u001b[1m Non-trainable params: \u001b[0m\u001b[38;5;34m0\u001b[0m (0.00 B)\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Non-trainable params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> (0.00 B)\n","</pre>\n"]},"metadata":{}}],"source":["from keras.models import Sequential\n","from keras.layers import Dense, Conv2D, MaxPooling2D, Flatten\n","model = tf.keras.models.Sequential()\n","\n","#lớp CNN1\n","model.add(Conv2D(32,(3,3), activation='relu', input_shape=(144,144,3)))\n","model.add(MaxPooling2D(2,2))\n","\n","#lớp CNN2\n","model.add(Conv2D(64,(3,3), activation='relu'))\n","model.add(MaxPooling2D(2,2))\n","\n","#lớp CNN3\n","model.add(Conv2D(128,(3,3), activation='relu'))\n","model.add(MaxPooling2D(2,2))\n","\n","#chuyển dữ liệu đầu ra của mạng CNN từ mảng 2 chiều về mảng 1 chiều\n","model.add(Flatten())\n","#lớp ẩn\n","model.add(Dense(512,activation=tf.nn.relu))\n","#lớp output\n","model.add(Dense(9,activation=tf.nn.softmax))\n","model.summary()"]},{"cell_type":"code","execution_count":22,"metadata":{"id":"e4gfCC9veBAp","executionInfo":{"status":"ok","timestamp":1724680704875,"user_tz":-420,"elapsed":387,"user":{"displayName":"Trang Trần","userId":"05226583947426864371"}}},"outputs":[],"source":["model.compile(loss = 'sparse_categorical_crossentropy',\n","              optimizer=keras.optimizers.Adam(learning_rate = 0.0001),\n","              metrics=['accuracy'])"]},{"cell_type":"code","execution_count":12,"metadata":{"id":"IyCYCXjLeDqN","executionInfo":{"status":"ok","timestamp":1724680141909,"user_tz":-420,"elapsed":7,"user":{"displayName":"Trang Trần","userId":"05226583947426864371"}}},"outputs":[],"source":["#creating the callback function so that it can be used to end the training in\n","#case reached a good accuracy rate (above 90%)\n","\n","class myCallback(tf.keras.callbacks.Callback):\n","  def on_epoch_end(self, epoch, logs={}):\n","    if(logs.get('accuracy')==1):\n","      print(\"\\nReached  100% accuracy so cancelling training!\")\n","      self.model.stop_training = True\n","\n","callbacks = myCallback()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ITRC-f7HeHAv","colab":{"base_uri":"https://localhost:8080/"},"outputId":"0a298c3f-2ed3-4953-aa7c-18b437884029"},"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/20\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/keras/src/trainers/data_adapters/py_dataset_adapter.py:121: UserWarning: Your `PyDataset` class should call `super().__init__(**kwargs)` in its constructor. `**kwargs` can include `workers`, `use_multiprocessing`, `max_queue_size`. Do not pass these arguments to `fit()`, as they will be ignored.\n","  self._warn_if_super_not_called()\n"]},{"output_type":"stream","name":"stdout","text":["\u001b[1m38/62\u001b[0m \u001b[32m━━━━━━━━━━━━\u001b[0m\u001b[37m━━━━━━━━\u001b[0m \u001b[1m44s\u001b[0m 2s/step - accuracy: 0.1559 - loss: 2.2107"]}],"source":["history = model.fit(train_generator,\n","                    epochs = 20, verbose = 1,\n","                    validation_data = validation_generator,\n","                    callbacks=[callbacks])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wH73gy55eShY","executionInfo":{"status":"aborted","timestamp":1724680188800,"user_tz":-420,"elapsed":7,"user":{"displayName":"Trang Trần","userId":"05226583947426864371"}}},"outputs":[],"source":["#đánh giá chất lượng của mô hình và vẽ lại\n","score = model.evaluate(validation_generator, verbose=0)\n","print('Sai số kiểm tra là: ', score[0])\n","print('Độ chính xác kiểm tra là: ', score[1])\n","\n","plt.figure(figsize=(10, 6))\n","\n","plt.plot(history.history['loss'], label='Training Loss')\n","plt.plot(history.history['accuracy'], label='Training Accuracy')\n","plt.plot(history.history['val_loss'], label='Validation Loss')\n","plt.plot(history.history['val_accuracy'], label='Validation Accuracy')\n","plt.title('NhanDienTien_Training')\n","plt.xlabel('Epoch')\n","plt.ylabel('Value')\n","plt.legend()\n","plt.show()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"SzryErsglNlt","executionInfo":{"status":"aborted","timestamp":1724680188800,"user_tz":-420,"elapsed":7,"user":{"displayName":"Trang Trần","userId":"05226583947426864371"}}},"outputs":[],"source":["model.save('/content/drive/MyDrive/hhtqd/nhandientien.h5')"]}],"metadata":{"colab":{"provenance":[{"file_id":"/v2/external/notebooks/intro.ipynb","timestamp":1718297060586}]},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}